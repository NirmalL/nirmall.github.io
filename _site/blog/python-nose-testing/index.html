<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>A Nose for Python: fun with test-driven development &#8211; Evil Dinosaur</title>
<meta name="description" content="Introduction to test-driven development philosophy and hands-on experience with Python 2.7 and Nose testing framework">
<meta name="keywords" content="python, code, tutorial, tech">


<!-- Twitter Cards -->
<meta name="twitter:title" content="A Nose for Python: fun with test-driven development">
<meta name="twitter:description" content="Introduction to test-driven development philosophy and hands-on experience with Python 2.7 and Nose testing framework">
<meta name="twitter:site" content="@srdyel">
<meta name="twitter:creator" content="@srdyel">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="/images/blog/python-featured.jpg">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="A Nose for Python: fun with test-driven development">
<meta property="og:description" content="Introduction to test-driven development philosophy and hands-on experience with Python 2.7 and Nose testing framework">
<meta property="og:url" content="/blog/python-nose-testing/">
<meta property="og:site_name" content="Evil Dinosaur">





<link rel="canonical" href="/blog/python-nose-testing/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Evil Dinosaur Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<!-- Webfonts -->
<script src="https://use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="/assets/js/vendor/html5shiv.min.js"></script>
  <script src="/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>


<!-- MathJax -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
      
		    
		    <li><a href="/about/" >About</a></li>
		  
		    
		    <li><a href="/articles/" >Articles</a></li>
		  
		    
		    <li><a href="/blog/" >Blog</a></li>
		  
		    
		    <li><a href="/search/" >Search</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<header class="masthead">
	
		<div class="wrap">
			<a href="/" class="site-logo" rel="home" title="Evil Dinosaur"><img src="/images/bio-photo.jpg" width="200" height="200" alt="Evil Dinosaur logo" class="animated fadeInDown"></a>
		</div>
	
</header><!-- /.masthead -->


<div class="js-menu-screen menu-screen"></div>


<div id="main" role="main">
  <article class="hentry">
    <img src="/images/blog/python-featured.jpg" class="entry-feature-image" alt="A Nose for Python: fun with test-driven development" ><p class="image-credit">Image credit: <a href="https://blog.cbtnuggets.com/wp-content/uploads/2014/10/5reasons_Python_FEATURED.jpg">blog.cbtnuggets.com</a></p>
    <div class="entry-wrapper">
      <header class="entry-header">
        <ul class="entry-tags">
          <li><a href="/tags/#python" title="Pages tagged python">python</a></li><li><a href="/tags/#code" title="Pages tagged code">code</a></li><li><a href="/tags/#tutorial" title="Pages tagged tutorial">tutorial</a></li><li><a href="/tags/#tech" title="Pages tagged tech">tech</a></li>
        </ul>
        
          <h1 class="entry-title">A Nose for Python: fun with test-driven development</h1>
        
      </header>
      <footer class="entry-meta">
        
        
          <img src="/images/bio-photo.jpg" class="bio-photo" alt="Nirmäl Lankä bio photo"></a>
        
        <span class="author vcard">By <span class="fn">Nirmäl Lankä</span></span>
        <span class="entry-date date published"><time datetime="2017-01-10T00:00:00+05:30"><i class="fa fa-calendar-o"></i> January 10, 2017</time></span>
        <span class="entry-date date modified"><time datetime="2017-01-11"><i class="fa fa-pencil"></i> January 11, 2017</time></span>
        <span class="entry-comments"><i class="fa fa-comment-o"></i> <a href="#disqus_thread">Comment</a></span>
        <span class="social-share-twitter">
  <a href="https://twitter.com/intent/tweet?hashtags=python,code,tutorial,tech&amp;text=A%20Nose%20for%20Python:%20fun%20with%20test-driven%20development&amp;url=/blog/python-nose-testing/&amp;via=srdyel" title="Share on Twitter" itemprop="Twitter"><i class="fa fa-twitter-square"></i> Tweet</a>
</span>
<span class="social-share-facebook">
  <a href="https://www.facebook.com/sharer/sharer.php?u=/blog/python-nose-testing/" title="Share on Facebook" itemprop="Facebook"><i class="fa fa-facebook-square"></i> Like</a>
</span>
<span class="social-share-googleplus">
  <a href="https://plus.google.com/share?url=/blog/python-nose-testing/" title="Share on Google Plus" itemprop="GooglePlus"><i class="fa fa-google-plus-square"></i> +1</a>
</span>
<!-- /.social-share -->
        
      </footer>
      <div class="entry-content">
        <p>In TDD (test-driven development), writing and maintaining tests—or unit-tests—are not thought-of 
as a burden that needs to be done to keep others happy. It’s not even a QA-only task, if at all.</p>

<p>In TDD, we write unit-test for our functionality, even before we start writing the functionality
itself. We make use of unit-tests to identify the ranges of input and the expected behavior of our 
(yet to be implemented) code.</p>

<p>That is in addition to what we would normally expect from a test: to make sure stuff works.</p>

<p>For each seemingly-mundane or even minimal code change, we can’t—and don’t want to—invest too
much time manually testing the functionality. That’s where generic automated tests come in. We write
automated tests of user-input and log the behavior of our software from a user-perspective, 
<em>user-perspective</em> being the keyword.</p>

<p>But maintaining such user-end automated tests, while quite helpful and arguably necessary, is 
nothing less of a hassle; not to mention the difficulty and time and processing wastage in following 
the user-end workflows again and again on every change to the code, processing feedback and debugging
stuff usually just before the release.</p>

<p>TDD is amazingly useful in such situations—i.e. always—to test the functionality in an abstract
manner, without depending on the bulk of all the layers of the software. In other words, we test
the code without relying on all the dependencies in our software system.</p>

<p>Confused? Don’t worry, I’ll be trying to explain this philosophy through some very simple examples.</p>

<p>You can see sample code repo, <a href="https://github.com/NirmalL/unit-testing">unit-testing</a> for the files,
but you don’t need to. ;)</p>

<h2 id="writing-a-trigonometry-library">Writing a trigonometry library</h2>

<p>No, no, don’t worry about what little you remember about trigonometry or anything too mathematical.
I assure you that knowledge is quite irrelevant here.</p>

<p>Assume we want to create a Python library of trigonometric functions. Take a look at the function
signatures of some of them:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># one.py</span>

<span class="k">def</span> <span class="nf">sin</span><span class="p">(</span><span class="n">rad</span><span class="p">):</span>
  <span class="k">pass</span>

<span class="k">def</span> <span class="nf">cos</span><span class="p">(</span><span class="n">rad</span><span class="p">):</span>
  <span class="k">pass</span>

<span class="k">def</span> <span class="nf">tan</span><span class="p">(</span><span class="n">rad</span><span class="p">):</span>
  <span class="k">pass</span>
</code></pre>
</div>

<p>You’ll notice we haven’t written any code for these functions. We’re going to identify the possible
input cases and write our code to fulfill those cases.</p>

<p>Here’s the test code skeleton we’re gonna use:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># test_one.py</span>

<span class="kn">from</span> <span class="nn">one</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">tan</span>
<span class="kn">import</span> <span class="nn">math</span><span class="o">,</span> <span class="nn">cmath</span>

<span class="kn">from</span> <span class="nn">nose.tools</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">setupf</span><span class="p">():</span>
  <span class="s">"Set up the instance for testing"</span>
  <span class="k">pass</span>

<span class="k">def</span> <span class="nf">teardownf</span><span class="p">():</span>
  <span class="s">"Tear down the instance"</span>
  <span class="k">pass</span>

<span class="nd">@with_setup</span><span class="p">(</span><span class="n">setupf</span><span class="p">,</span> <span class="n">teardownf</span><span class="p">)</span> <span class="c"># decorator</span>
<span class="k">def</span> <span class="nf">test_sin_float</span><span class="p">():</span>
  <span class="s">"Test for valid a float argument"</span>
  <span class="k">assert</span> <span class="bp">False</span>
</code></pre>
</div>

<p>We have imported our very own <code class="highlighter-rouge">one.py</code> module’s trignometric functions <code class="highlighter-rouge">sin</code>, <code class="highlighter-rouge">cos</code> and <code class="highlighter-rouge">tan</code>. 
We have also imported Python’s standard <code class="highlighter-rouge">math</code> library in order to use its versions of our trig 
functions for testing the output values of our code.</p>

<p>You’ll notice the almost empty <code class="highlighter-rouge">setupf</code>, <code class="highlighter-rouge">teardownf</code> and the decorator <code class="highlighter-rouge">@with_setup</code> which 
refers to them. <code class="highlighter-rouge">@with_setup</code> initiates any library and data setup mechanisms that are required
for each test. Where <code class="highlighter-rouge">setupf</code> would setup such configurations, data and service mocks and 
initiations, <code class="highlighter-rouge">teardown</code> would clean the setup after the use.</p>

<p>I’ve included them for completeness of the boilerplate code, but we’re not really going to need them 
for our library… at least not in this stage.</p>

<p>The test function also doesn’t do any actual testing yet, and we’ve set them to just ‘fail’ with
<code class="highlighter-rouge">assert False</code>.</p>

<p><code class="highlighter-rouge">assert</code> is the most generic of the mechanisms Nose (and Python) provide us with for concluding
a test case. Think of an assertion as a check whether the statement next to it is true or not.
If the code is wrong, the statement that’s asserted will be <code class="highlighter-rouge">False</code>. Look at the same function
with an actual assetion:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="nd">@with_setup</span><span class="p">(</span><span class="n">setupf</span><span class="p">,</span> <span class="n">teardownf</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_sin_float</span><span class="p">():</span>
  <span class="s">"Test for a valid float argument"</span>
  <span class="k">assert</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">sin</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>
</code></pre>
</div>

<p>Don’t worry about running the tests. We’ll come to that soon.</p>

<p>In the above code, we have compared the output of our <code class="highlighter-rouge">sin</code> function with Python’s <code class="highlighter-rouge">math</code> library’s
competitor’s output. The <code class="highlighter-rouge">assert</code> will hold true if both output the exact same value, compared with
<code class="highlighter-rouge">==</code>.</p>

<p>But we can’t expect them to be <em>exactly</em> the same output value; either our or Python’s function is
bound to be less accurate than the other in some way, only reliably similar to a certain number
of decimal places.</p>

<p>What we need to test is that these two outputs are sufficiently close to each other. In such 
unclear-precision comparisons we can use Nose’s <code class="highlighter-rouge">assert_almost_equal</code> function, which is 
self-explanatorily used below:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="nd">@with_setup</span><span class="p">(</span><span class="n">setupf</span><span class="p">,</span> <span class="n">teardownf</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_sin_float</span><span class="p">():</span>
  <span class="s">"Test for a valid float argument"</span>
  <span class="n">assert_almost_equals</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">),</span> <span class="n">places</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre>
</div>

<p>But we still haven’t implemented the <code class="highlighter-rouge">sin</code> function. So what will happen when we run the tests?
Let’s find out.</p>

<h2 id="installing-a-nose-and-testing-stuff-with-it">Installing a Nose and testing stuff with it</h2>

<p>You can use pip to quickly do a hassle-free installation of Nose on any major platform that has
pip and Python (2.7).</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>pip install nose
</code></pre>
</div>

<p>Now we can run the tests with either,</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>nosetests --verbose
</code></pre>
</div>

<p>or</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>nosetests ./test_one.py --verbose
</code></pre>
</div>

<p>As you will see, the tests will fail and after the test fail/pass report, it’ll print the 
stacktrace for each failure. We can now implement our functions so as to pass the test.</p>

<h2 id="implementing-sin">Implementing <code class="highlighter-rouge">sin</code></h2>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">e</span> <span class="o">=</span> <span class="mf">2.71828182846</span>

<span class="k">def</span> <span class="nf">sin</span><span class="p">(</span><span class="n">rad</span><span class="p">):</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">e</span><span class="o">**</span><span class="p">(</span><span class="n">rad</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">))</span><span class="o">.</span><span class="n">imag</span>
</code></pre>
</div>

<p>Written above is a basic way of calculating the sin value of a given radian value <code class="highlighter-rouge">rad</code>.
The equation in cleaner mathematics is,</p>

<p>\[ sin(x) = imag(e^{x \times j}) \]</p>

<p>Here, \( j \) is the imaginary unit, and \( imag \) represents the imaginary part of 
a complex number.</p>

<p>Now the tests should pass.</p>

<h2 id="more-test-cases">More test cases</h2>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="nd">@with_setup</span><span class="p">(</span><span class="n">setupf</span><span class="p">,</span> <span class="n">teardownf</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_sin_float</span><span class="p">():</span>
  <span class="s">"Test for a valid float argument"</span>
  <span class="n">assert_almost_equals</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">),</span> <span class="n">places</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="nd">@with_setup</span><span class="p">(</span><span class="n">setupf</span><span class="p">,</span> <span class="n">teardownf</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_sin_int</span><span class="p">():</span>
  <span class="s">"Test for a valid float argument"</span>
  <span class="n">assert_almost_equals</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">places</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="nd">@with_setup</span><span class="p">(</span><span class="n">setupf</span><span class="p">,</span> <span class="n">teardownf</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_sin_float_negative</span><span class="p">():</span>
  <span class="s">"Test for a valid negative float argument"</span>
  <span class="n">assert_almost_equals</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-.</span><span class="mi">1</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="o">-.</span><span class="mi">1</span><span class="p">),</span> <span class="n">places</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="nd">@with_setup</span><span class="p">(</span><span class="n">setupf</span><span class="p">,</span> <span class="n">teardownf</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_sin_float_negative</span><span class="p">():</span>
  <span class="s">"Test for a valid negative int argument"</span>
  <span class="n">assert_almost_equals</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="n">places</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="nd">@with_setup</span><span class="p">(</span><span class="n">setupf</span><span class="p">,</span> <span class="n">teardownf</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_sin_zero</span><span class="p">():</span>
  <span class="s">"Test for a valid negative float argument"</span>
  <span class="n">assert_almost_equals</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">places</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre>
</div>

<p>The above test cases use almost exactly the same code only with different arguments. 
This would make any self-respecting programmer want to either gouge their eyes out
or reuse the repeated code more efficiently. 
(<em>Yay, abstraction!</em>)</p>

<p>In addition, <code class="highlighter-rouge">@with_setup</code> will set up and tear down the test instance for each and every
test case. Knowing our code doesn’t hold grudges, I mean since it doesn’t carry the 
effect of previous executions, we can safely limit running them to a single time.</p>

<h2 id="test-generators-to-the-rescue"><em>Test generators</em> to the rescue!</h2>

<p>Wouldn’t it be wonderful to have a way of steamlining a list of test cases into a single
abstract tester function?</p>

<p>Test generators does exactly that!</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">test_sin_values</span><span class="p">():</span>
  <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
    <span class="k">yield</span> <span class="n">check_sin_values</span><span class="p">,</span> <span class="n">x</span>

<span class="nd">@with_setup</span><span class="p">(</span><span class="n">setupf</span><span class="p">,</span> <span class="n">teardownf</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">check_sin_values</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="s">"Test for a valid float argument"</span>
  <span class="n">assert_almost_equals</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">places</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre>
</div>

<p>We can generate a list of test data and test them one-by-one with the <code class="highlighter-rouge">check_</code> method.</p>

<p>Again, we can set to run the setting-up and tear-down process only once,
if there are no consequenses or effects of repeated calling on the function.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="nd">@with_setup</span><span class="p">(</span><span class="n">setupf</span><span class="p">,</span> <span class="n">teardownf</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_sin_values</span><span class="p">():</span>
  <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
    <span class="k">yield</span> <span class="n">check_sin_values</span><span class="p">,</span> <span class="n">x</span>

<span class="k">def</span> <span class="nf">check_sin_values</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="s">"Test for a valid float argument"</span>
  <span class="n">assert_almost_equals</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">places</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre>
</div>

<p>We can add more test cases:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="nd">@with_setup</span><span class="p">(</span><span class="n">setupf</span><span class="p">,</span> <span class="n">teardownf</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_sin_values</span><span class="p">():</span>
  <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
    <span class="k">yield</span> <span class="n">check_sin_values</span><span class="p">,</span> <span class="n">x</span>
  <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="n">j</span><span class="p">,</span> <span class="o">-.</span><span class="mi">1</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="n">j</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="mi">2</span><span class="n">j</span><span class="p">]:</span>
    <span class="k">yield</span> <span class="n">check_sin_values</span><span class="p">,</span> <span class="n">x</span>
  <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="o">-.</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]:</span>
    <span class="k">yield</span> <span class="n">check_sin_values_complex</span><span class="p">,</span> <span class="n">x</span>

<span class="c"># def check_sin_values ...</span>

<span class="k">def</span> <span class="nf">check_sin_values_complex</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="s">"Test for a valid complex float argument"</span>
  <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">x</span>
  <span class="n">mysin</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="nb">complex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>
  <span class="n">pysin</span> <span class="o">=</span> <span class="n">cmath</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="nb">complex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>
  <span class="n">assert_almost_equals</span><span class="p">(</span><span class="n">mysin</span><span class="p">,</span> <span class="n">pysin</span><span class="p">,</span> <span class="n">places</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre>
</div>

<p>output</p>
<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>nosetests ./test_one.py --verbose
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code>test_one.test_sin_values(-2,) ... ok
test_one.test_sin_values(-0.1,) ... ok
test_one.test_sin_values(0,) ... ok
test_one.test_sin_values(0.1,) ... ok
test_one.test_sin_values(2,) ... ok
test_one.test_sin_values(-2j,) ... ERROR
test_one.test_sin_values((-0-0.1j),) ... ERROR
test_one.test_sin_values(0j,) ... ERROR
test_one.test_sin_values(0.1j,) ... ERROR
test_one.test_sin_values(2j,) ... ERROR
test_one.test_sin_values((-2, -2),) ... ERROR
test_one.test_sin_values((-0.1, -0.1),) ... ERROR
test_one.test_sin_values((0, 0),) ... ok
test_one.test_sin_values((0.1, 0.1),) ... ERROR
test_one.test_sin_values((2, 2),) ... ERROR

============================================
ERROR: test_one.test_sin_values(-2j,)
--------------------------------------------
Traceback (most recent call last):
  File "c:\python27\lib\site-packages\nose\case.py", line 197, in runTest
    self.test(*self.arg)
  File "C:\users\nirmal\desktop\unit-testing\test_one.py", line 28, in check_sin_values
    assert_almost_equals(math.sin(x), sin(x), places=4)
TypeError: can't convert complex to float

============================================

...

--------------------------------------------
Ran 15 tests in 0.010s

FAILED (failures=9)
</code></pre>
</div>

<p>We can see that the complex numbered arguments make for completely inaccurate 
results in our <code class="highlighter-rouge">sin</code> function. We’ll need to fix or rethink our code to handle 
such values… or we could throw an exception.</p>

<p>To keep away from complex mathematics that’s out of scope of today’s subject, 
i’ll choose to do the latter.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">sin</span><span class="p">(</span><span class="n">rad</span><span class="p">):</span>
  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rad</span><span class="p">,</span> <span class="nb">complex</span><span class="p">):</span>
    <span class="k">raise</span> <span class="nb">ValueError</span><span class="p">(</span><span class="s">'sin(x) requires real arguments.'</span><span class="p">)</span> 
  <span class="k">return</span> <span class="p">(</span><span class="n">e</span><span class="o">**</span><span class="p">(</span><span class="n">rad</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">))</span><span class="o">.</span><span class="n">imag</span>
</code></pre>
</div>

<p>Then we’ll assert the raising of the exception, since that’s our (now) defined behavior.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">check_sin_values_complex</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="s">"Test for a valid complex float argument"</span>
  <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">x</span>
  <span class="n">assert_raises</span><span class="p">(</span><span class="nb">ValueError</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">p</span><span class="o">+</span><span class="nb">complex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>
</code></pre>
</div>

<p>This should get all the complex-number test cases to succeed.</p>

<p>But, the output doesn’t show our carefully crafted test descriptions, does it?</p>

<p>On the other hand, we have done some redundant tests. For example, we don’t need to check
for all negative values, floats and integers separately for testing complex input.</p>

<p>Let’s be more concise in defining test cases. We can identify the actual test cases are:</p>

<ol>
  <li>Real integers</li>
  <li>Real floats</li>
  <li>Zero</li>
  <li>Negative real (just testing floats should suffice)</li>
  <li>Complex-typed numbers (just floats)</li>
  <li>Pure imaginary numbers (just float)</li>
  <li>Complex-typed negative numbers (just float)</li>
</ol>

<p>Let’s test for them with separate <code class="highlighter-rouge">test_</code> functions so that we can also
see our test descriptions along with the pass/fail result.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="nd">@with_setup</span><span class="p">(</span><span class="n">setupf</span><span class="p">,</span> <span class="n">teardownf</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_sin_values_int</span><span class="p">():</span>
  <span class="s">"Test for a real intger argument"</span>
  <span class="n">assert_almost_equals</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">places</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="nd">@with_setup</span><span class="p">(</span><span class="n">setupf</span><span class="p">,</span> <span class="n">teardownf</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_sin_values_float</span><span class="p">():</span>
  <span class="s">"Test for a real float argument"</span>
  <span class="n">assert_almost_equals</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">.</span><span class="mi">4</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="o">.</span><span class="mi">4</span><span class="p">),</span> <span class="n">places</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="nd">@with_setup</span><span class="p">(</span><span class="n">setupf</span><span class="p">,</span> <span class="n">teardownf</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_sin_values_zero</span><span class="p">():</span>
  <span class="s">"Test for a zero-valued argument"</span>
  <span class="n">assert_almost_equals</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">places</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="nd">@with_setup</span><span class="p">(</span><span class="n">setupf</span><span class="p">,</span> <span class="n">teardownf</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_sin_values_negative</span><span class="p">():</span>
  <span class="s">"Test for a negative-valued argument"</span>
  <span class="n">assert_almost_equals</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-.</span><span class="mi">4</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="o">-.</span><span class="mi">4</span><span class="p">),</span> <span class="n">places</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
  <span class="n">assert_almost_equals</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">),</span> <span class="n">places</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="nd">@with_setup</span><span class="p">(</span><span class="n">setupf</span><span class="p">,</span> <span class="n">teardownf</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_sin_values_imaginary_int</span><span class="p">():</span>
  <span class="s">"Test for an imaginary integer argument"</span>
  <span class="n">assert_raises</span><span class="p">(</span><span class="nb">ValueError</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="mi">4</span><span class="n">j</span><span class="p">)</span>

<span class="nd">@with_setup</span><span class="p">(</span><span class="n">setupf</span><span class="p">,</span> <span class="n">teardownf</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_sin_values_imaginary</span><span class="p">():</span>
  <span class="s">"Test for an imaginary float argument"</span>
  <span class="n">assert_raises</span><span class="p">(</span><span class="nb">ValueError</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="o">.</span><span class="mi">4</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">)</span>

<span class="nd">@with_setup</span><span class="p">(</span><span class="n">setupf</span><span class="p">,</span> <span class="n">teardownf</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_sin_values_complex</span><span class="p">():</span>
  <span class="s">"Test for a complex argument"</span>
  <span class="n">assert_raises</span><span class="p">(</span><span class="nb">ValueError</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="o">.</span><span class="mi">3</span><span class="o">+.</span><span class="mi">4</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">)</span>
  <span class="n">assert_raises</span><span class="p">(</span><span class="nb">ValueError</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">)</span>

<span class="nd">@with_setup</span><span class="p">(</span><span class="n">setupf</span><span class="p">,</span> <span class="n">teardownf</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_sin_values_complex_negative</span><span class="p">():</span>
  <span class="s">"Test for a complex argument"</span>
  <span class="n">assert_raises</span><span class="p">(</span><span class="nb">ValueError</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="o">-.</span><span class="mi">3</span><span class="o">-.</span><span class="mi">4</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">)</span>
  <span class="n">assert_raises</span><span class="p">(</span><span class="nb">ValueError</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="notes">Notes</h2>

<p>We have done more than one assertion for some cases, to cover 
possibilities of that case. This way, if a specific sub-case fails, 
it’s not hard to isolate it, yet we’re not over-creating too-many unmanageable test-cases.</p>

<p>Selecting, ordering and sub-case testing for test cases is a subjective matter. 
It depends on the fine balancing between completeness and redundant bloat of test cases. 
We need to utilise our knowledge of the testee functionality to make good decisions.</p>

<p>Also, unit tests are not usually ultra-complete in their coverage of all possible cases 
because of human errors, imagination and variation of interest. If we still encounter 
bugs that escape the unit tests, we must add them to the list of tests for future use.</p>

<h2 id="whats-next">What’s next?</h2>

<p>This is just an introduction to the basic philosophy and use of unit testing. In the
up-coming posts, I plan on discussing subjects including:</p>

<ul>
  <li>Class method testing</li>
  <li>Mocking of data and services</li>
  <li>Code coverage principles</li>
</ul>

<p>I’m sure my understanding, interpretation and presentation of the subject matter is 
incomplete and error-prone. I’m open for discussion and corrections :)</p>

        
          <div id="disqus_thread"></div><!-- /#disqus_thread -->
          
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'evil-dinosaur'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    

<span>&copy; 2017 Nirmäl Lankä. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="https://mademistakes.com/work/so-simple-jekyll-theme/" rel="nofollow">So Simple Theme</a>.</span>
<div class="social-icons">
	<a href="https://twitter.com/srdyel" title="Nirmäl Lankä on Twitter" target="_blank"><i class="fa fa-twitter-square fa-2x"></i></a>
	<a href="https://facebook.com/nirmallankathilaka" title="Nirmäl Lankä on Facebook" target="_blank"><i class="fa fa-facebook-square fa-2x"></i></a>
	
	<a href="https://linkedin.com/in/nirmall" title="Nirmäl Lankä on LinkedIn" target="_blank"><i class="fa fa-linkedin-square fa-2x"></i></a>
	
	<a href="https://instagram.com/srdyel" title="Nirmäl Lankä on Instagram" target="_blank"><i class="fa fa-instagram fa-2x"></i></a>
	
	<a href="https://github.com/nirmall" title="Nirmäl Lankä on Github" target="_blank"><i class="fa fa-github-square fa-2x"></i></a>
	
  
	
  <a href="/feed.xml" title="Atom/RSS feed"><i class="fa fa-rss-square fa-2x"></i></a>
</div><!-- /.social-icons -->

  </footer>
</div><!-- /.footer-wrapper -->

<script type="text/javascript">
  var BASE_URL = '';
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>




</body>
</html>
